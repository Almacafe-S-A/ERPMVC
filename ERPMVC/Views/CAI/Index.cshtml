@using Kendo.Mvc.UI

@{
    ViewData["Title"] = "CAI";
}

<script>



    function DetallesCAI(e) {
        e.preventDefault();
        var dataItem = this.dataItem($(e.currentTarget).closest("tr"));
        window.location.href = "@Url.Action("Details", "CAI")?IdCAI=" + dataItem.IdCAI;
    }
</script>


@(Html.Kendo().Grid<ERPMVC.Models.CAI>
    ()
    .Name("gridCAI")
    .Columns(columns =>
    {
        columns.Bound(p => p.IdCAI).Width(100);
        columns.Bound(p => p._cai).Title("CAI").Width(190);
        columns.Bound(p => p.FechaRecepcion).Format("{0:dd/MM/yyyy}").Title("Fecha de recepcion").Width(160);
        columns.Bound(p => p.FechaLimiteEmision).Format("{0:dd/MM/yyyy}").Title("Fecha limite de emision").Width(150);
        columns.Bound(p => p.Estado).Width(120);
        //columns.Bound(p => p.FechaCreacion).Width(100);d
        //columns.Bound(p => p.FechaModificacion).Width(100);
        columns.Bound(p => p.UsuarioCreacion).Width(100);
        columns.Bound(p => p.UsuarioModificacion).Width(100);
        columns.Command(command => {
            //command.Custom("Ver detalles").Click("Detalles");
            command.Edit(); command.Destroy(); }).Width(250);

    })
    .ToolBar(tools =>
    {
        tools.Create();
        tools.Excel().HtmlAttributes(new { @class = "toolbar-field" });
        tools.Pdf().HtmlAttributes(new { @class = "toolbar-field" });



    })
    .Editable(e=>e.Mode(GridEditMode.InLine))
    .Sortable()
    .Pageable()
    .Filterable()
    .Scrollable()
    .Pdf(pdf => pdf.FileName("CAIReport" + DateTime.Now.Year + "_" + DateTime.Now.Month + "_"
    + DateTime.Now.Day + "_" + DateTime.Now.Hour + "_" + DateTime.Now.Minute + "_" + DateTime.Now.Second + ".pdf")
    .ProxyURL(Url.Action("Export", "Home")).AllPages())
        .Excel(excel => excel.FileName("CAIReport_" + DateTime.Now.Year + "_" + DateTime.Now.Month + "_"
    + DateTime.Now.Day + "_" + DateTime.Now.Hour + "_" + DateTime.Now.Minute + "_" + DateTime.Now.Second + ".xlsx").Filterable(true)
    .ProxyURL(Url.Action("Export", "Home")).AllPages(true))
    .DataSource(dataSource =>
        dataSource
        .WebApi()
        .ServerOperation(true)
        .Model(model =>
        {
            model.Id(p => p.IdCAI);
            model.Field(p => p.IdCAI).Editable(false);
            model.Field(p => p._cai).Editable(true);
            model.Field(p => p.FechaCreacion).Editable(true);
            model.Field(p => p.FechaLimiteEmision).Editable(true);
            model.Field(p => p.Estado).Editable(true);
        })
        .Events(events => events.Error("error_handler"))
        .Read(read => read.Action("Get", "CAI"))
        .Create(create => create.Action("Insert", "CAI"))
        .Update(update => update.Action("Update", "CAI", new { id = "{0}" }))
        .Destroy(destroy => destroy.Action("Delete", "CAI", new { id = "{0}" }))
    )
)



